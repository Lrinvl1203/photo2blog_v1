<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoToBlog - AI ë¸”ë¡œê·¸ ìƒì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --secondary-color: #64748b;
            --success-color: #059669;
            --error-color: #dc2626;
            --warning-color: #d97706;
            --background: #ffffff;
            --surface: #f8fafc;
            --border: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
        }

        [data-theme="dark"] {
            --background: #0f172a;
            --surface: #1e293b;
            --border: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Main Content */
        .main {
            min-height: calc(100vh - 160px);
            padding: 2rem 0;
        }

        .hero {
            text-align: center;
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-color), #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* API Key Section */
        .api-key-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .api-key-section.error {
            border-color: var(--error-color);
            background: #fef2f2;
        }

        [data-theme="dark"] .api-key-section.error {
            background: #1f1a1a;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--background);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s ease;
            text-align: center;
            justify-content: center;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--border);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-error {
            background: var(--error-color);
            color: white;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        /* Photo Upload */
        .photo-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .photo-item {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .photo-preview {
            width: 150px;
            height: 100px;
            border: 2px dashed var(--border);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
            overflow: hidden;
        }

        .photo-preview:hover {
            border-color: var(--primary-color);
            background: var(--surface);
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }

        .photo-content {
            flex: 1;
        }

        /* Language & Theme Controls */
        .select {
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--background);
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--background);
            border-radius: 12px;
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            padding: 0.75rem 1rem;
            border: none;
            background: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Tone Adjuster */
        .tone-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .tone-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .photo-item {
                flex-direction: column;
            }
            
            .photo-preview {
                width: 100%;
                height: 150px;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .tone-controls {
                grid-template-columns: 1fr;
            }
        }

        /* Utility Classes */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-error { color: var(--error-color); }
        .text-success { color: var(--success-color); }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mt-2 { margin-top: 1rem; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .w-full { width: 100%; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">PhotoToBlog</div>
                <div class="header-controls">
                    <select id="languageSelect" class="select">
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="en">English</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="zh">ä¸­æ–‡</option>
                        <option value="es">EspaÃ±ol</option>
                        <option value="fr">FranÃ§ais</option>
                    </select>
                    <button id="themeToggle" class="btn btn-secondary btn-small">ğŸŒ™</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Hero Section -->
            <div class="hero">
                <h1 data-i18n="app_title">ëª‡ ì´ˆ ë§Œì— ë©‹ì§„ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°</h1>
                <p data-i18n="app_subtitle">ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê³ , ì„¸ë¶€ ì •ë³´ë¥¼ ì¶”ê°€í•˜ë©´ AIê°€ ê¸€ì„ ì‘ì„±í•´ ë“œë¦½ë‹ˆë‹¤.</p>
            </div>

            <!-- API Key Section -->
            <div class="api-key-section" id="apiKeySection">
                <div class="form-group">
                    <label class="form-label" data-i18n="api_key_label">Gemini API í‚¤</label>
                    <input type="password" id="apiKey" class="form-input" placeholder="AIzaSy..." data-i18n-placeholder="api_key_placeholder">
                    <small style="color: var(--text-muted); margin-top: 0.5rem; display: block;" data-i18n="api_key_help">
                        Google AI Studioì—ì„œ ë¬´ë£Œë¡œ API í‚¤ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </small>
                </div>
            </div>

            <!-- Main App Container -->
            <div id="appContainer">
                <!-- Blog Generator Form -->
                <div id="blogForm" class="form-section">
                    <div class="form-group">
                        <label class="form-label" data-i18n="form_category_label">ë¸”ë¡œê·¸ ì¹´í…Œê³ ë¦¬</label>
                        <input type="text" id="category" class="form-input" data-i18n-placeholder="form_category_placeholder">
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="form_topic_label">ì£¼ì œ / ì£¼ìš” ì•„ì´ë””ì–´</label>
                        <input type="text" id="topic" class="form-input" data-i18n-placeholder="form_topic_placeholder">
                    </div>

                    <div class="photo-section">
                        <h3 class="mb-2" data-i18n="form_photos_title">ì‚¬ì§„ & ì„¤ëª…</h3>
                        <div id="photoContainer"></div>
                        <button type="button" id="addPhotoBtn" class="btn btn-secondary">
                            â• <span data-i18n="form_add_photos_button">ì‚¬ì§„ ì¶”ê°€í•˜ê¸°</span>
                        </button>
                    </div>

                    <div class="text-center">
                        <button type="button" id="reviewBtn" class="btn btn-primary">
                            <span data-i18n="form_review_prompt_button">í”„ë¡¬í”„íŠ¸ ê²€í† </span>
                        </button>
                    </div>
                </div>

                <!-- Loading Section -->
                <div id="loadingSection" class="hidden text-center">
                    <div class="spinner" style="width: 40px; height: 40px; margin-bottom: 1rem;"></div>
                    <p id="loadingMessage" style="color: var(--text-secondary);">AIì˜ ì°½ì˜ë ¥ì„ ì˜ˆì—´ ì¤‘...</p>
                </div>

                <!-- Blog Output Section -->
                <div id="blogOutput" class="hidden">
                    <div class="flex justify-between items-center mb-2">
                        <h2 data-i18n="output_title">ìƒì„±ëœ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸</h2>
                        <div class="flex gap-1">
                            <button id="addContentBtn" class="btn btn-secondary btn-small">
                                <span data-i18n="output_add_modify_button">ì½˜í…ì¸  ì¶”ê°€/ìˆ˜ì •</span>
                            </button>
                            <button id="adjustToneBtn" class="btn btn-secondary btn-small">
                                <span data-i18n="output_adjust_tone_button">í†¤ ì¡°ì ˆ</span>
                            </button>
                            <button id="createAnotherBtn" class="btn btn-secondary btn-small">
                                <span data-i18n="output_create_another_button">ë‹¤ë¥¸ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°</span>
                            </button>
                        </div>
                    </div>

                    <div class="tabs">
                        <button class="tab active" data-tab="preview" data-i18n="output_tab_preview">ë¯¸ë¦¬ë³´ê¸°</button>
                        <button class="tab" data-tab="html" data-i18n="output_tab_html">HTML</button>
                        <button class="tab" data-tab="markdown" data-i18n="output_tab_markdown">ë§ˆí¬ë‹¤ìš´</button>
                        <button class="tab" data-tab="text" data-i18n="output_tab_text">í…ìŠ¤íŠ¸</button>
                    </div>

                    <div class="tab-content active" id="previewTab">
                        <div id="blogPreview" style="background: var(--surface); padding: 2rem; border-radius: 8px; border: 1px solid var(--border);"></div>
                    </div>

                    <div class="tab-content" id="htmlTab">
                        <div style="position: relative;">
                            <button class="btn btn-small btn-secondary" style="position: absolute; top: 10px; right: 10px; z-index: 10;" onclick="copyToClipboard('htmlContent')">
                                <span data-i18n="output_copy_html">HTML ë³µì‚¬</span>
                            </button>
                            <pre id="htmlContent" style="background: var(--surface); padding: 2rem; border-radius: 8px; border: 1px solid var(--border); overflow-x: auto; white-space: pre-wrap;"></pre>
                        </div>
                    </div>

                    <div class="tab-content" id="markdownTab">
                        <div style="position: relative;">
                            <button class="btn btn-small btn-secondary" style="position: absolute; top: 10px; right: 10px; z-index: 10;" onclick="copyToClipboard('markdownContent')">
                                <span data-i18n="output_copy_markdown">ë§ˆí¬ë‹¤ìš´ ë³µì‚¬</span>
                            </button>
                            <pre id="markdownContent" style="background: var(--surface); padding: 2rem; border-radius: 8px; border: 1px solid var(--border); overflow-x: auto; white-space: pre-wrap;"></pre>
                        </div>
                    </div>

                    <div class="tab-content" id="textTab">
                        <div style="position: relative;">
                            <button class="btn btn-small btn-secondary" style="position: absolute; top: 10px; right: 10px; z-index: 10;" onclick="copyToClipboard('textContent')">
                                <span data-i18n="output_copy_text">í…ìŠ¤íŠ¸ ë³µì‚¬</span>
                            </button>
                            <pre id="textContent" style="background: var(--surface); padding: 2rem; border-radius: 8px; border: 1px solid var(--border); overflow-x: auto; white-space: pre-wrap;"></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Prompt Review Modal -->
    <div id="promptModal" class="modal">
        <div class="modal-content" style="width: 800px;">
            <h2 class="mb-2" data-i18n="review_title">í”„ë¡¬í”„íŠ¸ ê²€í† </h2>
            <p class="mb-2" style="color: var(--text-secondary);" data-i18n="review_subtitle">AIê°€ ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì•„ë˜ì—ì„œ ìˆ˜ì •í•˜ì—¬ ì§€ì¹¨ì„ êµ¬ì²´í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            
            <div class="form-group">
                <label class="form-label" data-i18n="review_word_count_label">ëª©í‘œ ê¸€ì ìˆ˜</label>
                <select id="wordCountSelect" class="form-input">
                    <option value="800" data-i18n="review_wc_option_1">ì•½ 800ì</option>
                    <option value="1500" data-i18n="review_wc_option_2">ì•½ 1500ì</option>
                    <option value="2000" selected data-i18n="review_wc_option_3">ì•½ 2000ì (ê¸°ë³¸)</option>
                    <option value="2500" data-i18n="review_wc_option_4">ì•½ 2500ì ì´ìƒ</option>
                    <option value="custom" data-i18n="review_wc_option_5">ì§ì ‘ ì…ë ¥</option>
                </select>
                <input type="number" id="customWordCount" class="form-input mt-2 hidden" placeholder="1200" min="100" max="10000">
            </div>

            <div class="form-group">
                <label class="form-label">í”„ë¡¬í”„íŠ¸</label>
                <textarea id="promptText" class="form-input form-textarea" rows="10"></textarea>
            </div>

            <div class="flex gap-2 justify-between">
                <button id="promptBackBtn" class="btn btn-secondary" data-i18n="review_back_button">ì–‘ì‹ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
                <button id="confirmGenerateBtn" class="btn btn-primary" data-i18n="review_confirm_button">í™•ì¸ & ìƒì„±</button>
            </div>
        </div>
    </div>

    <!-- Add Content Modal -->
    <div id="addContentModal" class="modal">
        <div class="modal-content" style="width: 800px;">
            <h2 class="mb-2" data-i18n="output_addup_title">ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì— ë‚´ìš© ì¶”ê°€í•˜ê¸°</h2>
            
            <div class="form-group">
                <label class="form-label" data-i18n="output_addup_instructions_label">ì¶”ê°€ ì§€ì¹¨</label>
                <textarea id="addInstructions" class="form-input form-textarea" rows="4" data-i18n-placeholder="output_addup_instructions_placeholder"></textarea>
            </div>

            <div class="form-group">
                <label class="form-label" data-i18n="output_addup_photos_title">ì‚¬ì§„ ë” ì¶”ê°€í•˜ê¸°</label>
                <div id="additionalPhotos"></div>
                <button type="button" id="addMorePhotoBtn" class="btn btn-secondary btn-small mt-2">
                    â• <span data-i18n="output_addup_add_photo_field_button">ì‚¬ì§„ í•„ë“œ ì¶”ê°€</span>
                </button>
            </div>

            <div class="flex gap-2 justify-between">
                <button id="addContentCancelBtn" class="btn btn-secondary" data-i18n="output_addup_cancel_button">ì·¨ì†Œ</button>
                <button id="addContentConfirmBtn" class="btn btn-primary" data-i18n="output_addup_regenerate_button">ì¶”ê°€í•˜ì—¬ ë‹¤ì‹œ ìƒì„±</button>
            </div>
        </div>
    </div>

    <!-- Tone Adjust Modal -->
    <div id="toneModal" class="modal">
        <div class="modal-content" style="width: 800px;">
            <h2 class="mb-2" data-i18n="tone_adjuster_title">ë¸”ë¡œê·¸ ê¸€ í†¤ ì¡°ì ˆí•˜ê¸°</h2>
            
            <div class="tone-controls">
                <div class="tone-group">
                    <label class="form-label" data-i18n="tone_formality">ê²©ì‹</label>
                    <select id="toneFormality" class="form-input">
                        <option value="ì¼ìƒì ">ì¼ìƒì </option>
                        <option value="ë¹„ê³µì‹ì ">ë¹„ê³µì‹ì </option>
                        <option value="ì¤‘ë¦½ì " selected>ì¤‘ë¦½ì </option>
                        <option value="ê³µì‹ì ">ê³µì‹ì </option>
                        <option value="ì „ë¬¸ì ">ì „ë¬¸ì </option>
                    </select>
                </div>

                <div class="tone-group">
                    <label class="form-label" data-i18n="tone_enthusiasm">ì—´ì •</label>
                    <select id="toneEnthusiasm" class="form-input">
                        <option value="ì°¨ë¶„í•¨">ì°¨ë¶„í•¨</option>
                        <option value="í‰ì˜¨í•¨">í‰ì˜¨í•¨</option>
                        <option value="ì¤‘ë¦½ì " selected>ì¤‘ë¦½ì </option>
                        <option value="í™œê¸°ì°¸">í™œê¸°ì°¸</option>
                        <option value="ì—´ì •ì ">ì—´ì •ì </option>
                    </select>
                </div>

                <div class="tone-group">
                    <label class="form-label" data-i18n="tone_confidence">ìì‹ ê°</label>
                    <select id="toneConfidence" class="form-input">
                        <option value="ê°ê´€ì ">ê°ê´€ì </option>
                        <option value="ì‹ ì¤‘í•¨">ì‹ ì¤‘í•¨</option>
                        <option value="ì¤‘ë¦½ì " selected>ì¤‘ë¦½ì </option>
                        <option value="ìì‹ ê°ìˆìŒ">ìì‹ ê°ìˆìŒ</option>
                        <option value="ë‹¨í˜¸í•¨">ë‹¨í˜¸í•¨</option>
                    </select>
                </div>

                <div class="tone-group">
                    <label class="form-label" data-i18n="tone_humor">ìœ ë¨¸</label>
                    <select id="toneHumor" class="form-input">
                        <option value="ì§„ì§€í•¨">ì§„ì§€í•¨</option>
                        <option value="ë¬´ë¯¸ê±´ì¡°">ë¬´ë¯¸ê±´ì¡°</option>
                        <option value="ì¤‘ë¦½ì " selected>ì¤‘ë¦½ì </option>
                        <option value="ì¬ì¹˜ìˆìŒ">ì¬ì¹˜ìˆìŒ</option>
                        <option value="ìœ„íŠ¸ìˆìŒ">ìœ„íŠ¸ìˆìŒ</option>
                    </select>
                </div>

                <div class="tone-group">
                    <label class="form-label" data-i18n="tone_clarity">ëª…í™•ì„±</label>
                    <select id="toneClarity" class="form-input">
                        <option value="ë‹¨ìˆœí•¨">ë‹¨ìˆœí•¨</option>
                        <option value="ê°„ê²°í•¨">ê°„ê²°í•¨</option>
                        <option value="ì¤‘ë¦½ì " selected>ì¤‘ë¦½ì </option>
                        <option value="ìƒì„¸í•¨">ìƒì„¸í•¨</option>
                        <option value="ì „ë¬¸ì ">ì „ë¬¸ì </option>
                    </select>
                </div>
            </div>

            <div class="flex gap-2 justify-between">
                <button id="toneCancelBtn" class="btn btn-secondary" data-i18n="tone_cancel_button">ì·¨ì†Œ</button>
                <button id="toneConfirmBtn" class="btn btn-primary" data-i18n="tone_regenerate_button">ìƒˆë¡œìš´ í†¤ìœ¼ë¡œ ë‹¤ì‹œ ìƒì„±</button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒíƒœ ê´€ë¦¬
        let currentState = {
            apiKey: '',
            language: 'ko',
            theme: 'light',
            photos: [],
            generatedBlog: null,
            isLoading: false
        };

        // ë‹¤êµ­ì–´ ì§€ì›
        const translations = {
            ko: {
                app_title: 'ëª‡ ì´ˆ ë§Œì— ë©‹ì§„ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°',
                app_subtitle: 'ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê³ , ì„¸ë¶€ ì •ë³´ë¥¼ ì¶”ê°€í•˜ë©´ AIê°€ ê¸€ì„ ì‘ì„±í•´ ë“œë¦½ë‹ˆë‹¤.',
                api_key_label: 'Gemini API í‚¤',
                api_key_placeholder: 'AIzaSy... (Google AI Studioì—ì„œ ë°›ìœ¼ì„¸ìš”)',
                api_key_help: 'Google AI Studioì—ì„œ ë¬´ë£Œë¡œ API í‚¤ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                form_category_label: 'ë¸”ë¡œê·¸ ì¹´í…Œê³ ë¦¬',
                form_category_placeholder: 'ì˜ˆ: ì—¬í–‰, ìŒì‹, ê¸°ìˆ ',
                form_topic_label: 'ì£¼ì œ / ì£¼ìš” ì•„ì´ë””ì–´',
                form_topic_placeholder: 'ì˜ˆ: ë‚˜ì˜ ë†€ë¼ìš´ ì œì£¼ë„ ì—¬í–‰',
                form_photos_title: 'ì‚¬ì§„ & ì„¤ëª…',
                form_upload_photo: 'ì‚¬ì§„ ì—…ë¡œë“œ',
                form_photo_desc_placeholder: "ì´ ì‚¬ì§„ì„ ì„¤ëª…í•´ì£¼ì„¸ìš” (ì˜ˆ: 'ë°”ë‹¤ ìœ„ë¡œ ì§€ëŠ” ì•„ë¦„ë‹¤ìš´ ì¼ëª°')",
                form_add_photos_button: 'ì‚¬ì§„ ì¶”ê°€í•˜ê¸°',
                form_review_prompt_button: 'í”„ë¡¬í”„íŠ¸ ê²€í† ',
                review_title: 'í”„ë¡¬í”„íŠ¸ ê²€í† ',
                review_subtitle: 'AIê°€ ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì•„ë˜ì—ì„œ ìˆ˜ì •í•˜ì—¬ ì§€ì¹¨ì„ êµ¬ì²´í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                review_word_count_label: 'ëª©í‘œ ê¸€ì ìˆ˜',
                review_wc_option_1: 'ì•½ 800ì',
                review_wc_option_2: 'ì•½ 1500ì',
                review_wc_option_3: 'ì•½ 2000ì (ê¸°ë³¸)',
                review_wc_option_4: 'ì•½ 2500ì ì´ìƒ',
                review_wc_option_5: 'ì§ì ‘ ì…ë ¥',
                review_back_button: 'ì–‘ì‹ìœ¼ë¡œ ëŒì•„ê°€ê¸°',
                review_confirm_button: 'í™•ì¸ & ìƒì„±',
                output_title: 'ìƒì„±ëœ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸',
                output_add_modify_button: 'ì½˜í…ì¸  ì¶”ê°€/ìˆ˜ì •',
                output_adjust_tone_button: 'í†¤ ì¡°ì ˆ',
                output_create_another_button: 'ë‹¤ë¥¸ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°',
                output_tab_preview: 'ë¯¸ë¦¬ë³´ê¸°',
                output_tab_html: 'HTML',
                output_tab_markdown: 'ë§ˆí¬ë‹¤ìš´',
                output_tab_text: 'í…ìŠ¤íŠ¸',
                output_copy_html: 'HTML ë³µì‚¬',
                output_copy_markdown: 'ë§ˆí¬ë‹¤ìš´ ë³µì‚¬',
                output_copy_text: 'í…ìŠ¤íŠ¸ ë³µì‚¬',
                output_addup_title: 'ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì— ë‚´ìš© ì¶”ê°€í•˜ê¸°',
                output_addup_instructions_label: 'ì¶”ê°€ ì§€ì¹¨',
                output_addup_instructions_placeholder: 'ì˜ˆ: ìš°ë¦¬ê°€ ë¨¹ì–´ë³¸ í˜„ì§€ ìŒì‹ì— ëŒ€í•œ ì„¹ì…˜ì„ ì¶”ê°€í•´ì¤˜. ê²°ë¡ ì„ ë” ë‚™ê´€ì ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜.',
                output_addup_photos_title: 'ì‚¬ì§„ ë” ì¶”ê°€í•˜ê¸°',
                output_addup_add_photo_field_button: 'ì‚¬ì§„ í•„ë“œ ì¶”ê°€',
                output_addup_cancel_button: 'ì·¨ì†Œ',
                output_addup_regenerate_button: 'ì¶”ê°€í•˜ì—¬ ë‹¤ì‹œ ìƒì„±',
                tone_adjuster_title: 'ë¸”ë¡œê·¸ ê¸€ í†¤ ì¡°ì ˆí•˜ê¸°',
                tone_formality: 'ê²©ì‹',
                tone_enthusiasm: 'ì—´ì •',
                tone_confidence: 'ìì‹ ê°',
                tone_humor: 'ìœ ë¨¸',
                tone_clarity: 'ëª…í™•ì„±',
                tone_cancel_button: 'ì·¨ì†Œ',
                tone_regenerate_button: 'ìƒˆë¡œìš´ í†¤ìœ¼ë¡œ ë‹¤ì‹œ ìƒì„±',
                error_api_key_required: 'Gemini API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                error_form_validation: 'ì¹´í…Œê³ ë¦¬, ì£¼ì œ, ê·¸ë¦¬ê³  ì„¤ëª…ì´ í¬í•¨ëœ ì‚¬ì§„ì„ í•˜ë‚˜ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                error_generation_failed: 'ë¸”ë¡œê·¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
                success_copied: 'ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!',
                loading_message_1: "AIì˜ ì°½ì˜ë ¥ì„ ì˜ˆì—´ ì¤‘...",
                loading_message_2: "ì•„ë¦„ë‹¤ìš´ ì‚¬ì§„ë“¤ì„ ë¶„ì„ ì¤‘...",
                loading_message_3: "í¥ë¯¸ë¡œìš´ ì´ì•¼ê¸°ì˜ ì´ˆì•ˆì„ ì‘ì„± ì¤‘...",
                loading_message_4: "ì™„ë²½í•œ ë‹¨ì–´ë“¤ì„ ì°¾ëŠ” ì¤‘...",
                loading_message_5: "ë§ˆì§€ë§‰ ë¬¸ì¥ë“¤ì„ ë‹¤ë“¬ëŠ” ì¤‘...",
                loading_message_6: "ê±°ì˜ ë‹¤ ì™”ì–´ìš”, ë§ˆë²•ì´ ì¼ì–´ë‚˜ê³  ìˆìŠµë‹ˆë‹¤!"
            },
            en: {
                app_title: 'Create Stunning Blogs in Seconds',
                app_subtitle: 'Upload your photos, add some details, and let our AI do the writing for you.',
                api_key_label: 'Gemini API Key',
                api_key_placeholder: 'AIzaSy... (Get it from Google AI Studio)',
                api_key_help: 'You can get a free API key from Google AI Studio.',
                form_category_label: 'Blog Category',
                form_category_placeholder: 'e.g., Travel, Food, Technology',
                form_topic_label: 'Topic / Main Idea',
                form_topic_placeholder: 'e.g., My amazing trip to Jeju Island',
                form_photos_title: 'Photos & Descriptions',
                form_upload_photo: 'Upload Photo',
                form_photo_desc_placeholder: "Describe this photo (e.g., 'A beautiful sunset over the ocean')",
                form_add_photos_button: 'Add More Photos',
                form_review_prompt_button: 'Review Prompt',
                review_title: 'Review Your Prompt',
                review_subtitle: 'The AI will use this prompt to generate your blog post. You can edit it below to refine the instructions.',
                review_word_count_label: 'Target Word Count',
                review_wc_option_1: 'Approx. 800 words',
                review_wc_option_2: 'Approx. 1500 words',
                review_wc_option_3: 'Approx. 2000 words (Default)',
                review_wc_option_4: 'Approx. 2500+ words',
                review_wc_option_5: 'Custom',
                review_back_button: 'Back to Form',
                review_confirm_button: 'Confirm & Generate',
                output_title: 'Your Generated Blog Post',
                output_add_modify_button: 'Add/Modify Content',
                output_adjust_tone_button: 'Adjust Tone',
                output_create_another_button: 'Create Another Blog Post',
                output_tab_preview: 'Preview',
                output_tab_html: 'HTML',
                output_tab_markdown: 'Markdown',
                output_tab_text: 'Text',
                output_copy_html: 'Copy HTML',
                output_copy_markdown: 'Copy Markdown',
                output_copy_text: 'Copy Text',
                output_addup_title: 'Add to Your Blog Post',
                output_addup_instructions_label: 'Additional Instructions',
                output_addup_instructions_placeholder: 'e.g., Add a section about the local food we tried. Make the conclusion more optimistic.',
                output_addup_photos_title: 'Add More Photos',
                output_addup_add_photo_field_button: 'Add Photo Field',
                output_addup_cancel_button: 'Cancel',
                output_addup_regenerate_button: 'Regenerate with Additions',
                tone_adjuster_title: 'Adjust the Tone of Your Post',
                tone_formality: 'Formality',
                tone_enthusiasm: 'Enthusiasm',
                tone_confidence: 'Confidence',
                tone_humor: 'Humor',
                tone_clarity: 'Clarity',
                tone_cancel_button: 'Cancel',
                tone_regenerate_button: 'Regenerate with New Tone',
                error_api_key_required: 'Please enter your Gemini API key.',
                error_form_validation: 'Please fill in the category, topic, and at least one photo with a description.',
                error_generation_failed: 'Failed to generate blog post. Please check your API key and try again.',
                success_copied: 'Copied!',
                loading_message_1: "Warming up the AI's creativity...",
                loading_message_2: "Analyzing your beautiful photos...",
                loading_message_3: "Drafting a compelling story...",
                loading_message_4: "Finding the perfect words...",
                loading_message_5: "Polishing the final sentences...",
                loading_message_6: "Almost there, the magic is happening!"
            }
        };

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            addInitialPhoto();
        });

        function initializeApp() {
            // í…Œë§ˆ ì´ˆê¸°í™”
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            // ì–¸ì–´ ì´ˆê¸°í™”
            updateLanguage(currentState.language);
        }

        function setupEventListeners() {
            // í…Œë§ˆ í† ê¸€
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // ì–¸ì–´ ì„ íƒ
            document.getElementById('languageSelect').addEventListener('change', (e) => {
                updateLanguage(e.target.value);
            });

            // ì‚¬ì§„ ì¶”ê°€ ë²„íŠ¼
            document.getElementById('addPhotoBtn').addEventListener('click', addPhotoField);

            // í”„ë¡¬í”„íŠ¸ ê²€í†  ë²„íŠ¼
            document.getElementById('reviewBtn').addEventListener('click', openPromptReview);

            // ëª¨ë‹¬ ì´ë²¤íŠ¸ë“¤
            setupModalEvents();

            // íƒ­ ì´ë²¤íŠ¸ë“¤
            setupTabEvents();

            // ê¸€ììˆ˜ ì„ íƒ ì´ë²¤íŠ¸
            document.getElementById('wordCountSelect').addEventListener('change', function() {
                const customInput = document.getElementById('customWordCount');
                if (this.value === 'custom') {
                    customInput.classList.remove('hidden');
                } else {
                    customInput.classList.add('hidden');
                }
            });
        }

        function setupModalEvents() {
            // í”„ë¡¬í”„íŠ¸ ëª¨ë‹¬
            document.getElementById('promptBackBtn').addEventListener('click', () => {
                document.getElementById('promptModal').classList.remove('show');
            });
            document.getElementById('confirmGenerateBtn').addEventListener('click', generateBlogPost);

            // ì½˜í…ì¸  ì¶”ê°€ ëª¨ë‹¬
            document.getElementById('addContentBtn').addEventListener('click', openAddContentModal);
            document.getElementById('addContentCancelBtn').addEventListener('click', () => {
                document.getElementById('addContentModal').classList.remove('show');
            });
            document.getElementById('addContentConfirmBtn').addEventListener('click', addContentToBlog);
            document.getElementById('addMorePhotoBtn').addEventListener('click', addAdditionalPhoto);

            // í†¤ ì¡°ì • ëª¨ë‹¬
            document.getElementById('adjustToneBtn').addEventListener('click', openToneModal);
            document.getElementById('toneCancelBtn').addEventListener('click', () => {
                document.getElementById('toneModal').classList.remove('show');
            });
            document.getElementById('toneConfirmBtn').addEventListener('click', adjustTone);

            // ë‹¤ë¥¸ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°
            document.getElementById('createAnotherBtn').addEventListener('click', resetApp);

            // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('show');
                    }
                });
            });
        }

        function setupTabEvents() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.tab;
                    
                    // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                    
                    // ì„ íƒëœ íƒ­ í™œì„±í™”
                    tab.classList.add('active');
                    document.getElementById(tabName + 'Tab').classList.add('active');
                });
            });
        }

        function toggleTheme() {
            const newTheme = currentState.theme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        }

        function setTheme(theme) {
            currentState.theme = theme;
            document.body.dataset.theme = theme;
            document.getElementById('themeToggle').textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', theme);
        }

        function updateLanguage(lang) {
            currentState.language = lang;
            document.getElementById('languageSelect').value = lang;
            
            // ëª¨ë“  ë‹¤êµ­ì–´ ìš”ì†Œ ì—…ë°ì´íŠ¸
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.dataset.i18n;
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // placeholder ì—…ë°ì´íŠ¸
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.dataset.i18nPlaceholder;
                if (translations[lang] && translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });
        }

        function t(key) {
            return translations[currentState.language][key] || key;
        }

        function addInitialPhoto() {
            addPhotoField();
        }

        function addPhotoField() {
            const container = document.getElementById('photoContainer');
            const photoId = Date.now();
            
            const photoDiv = document.createElement('div');
            photoDiv.className = 'photo-item';
            photoDiv.dataset.photoId = photoId;
            
            photoDiv.innerHTML = `
                <div class="photo-preview" onclick="document.getElementById('file-${photoId}').click()">
                    <div class="upload-placeholder">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <polyline points="21,15 16,10 5,21"/>
                        </svg>
                        <span>${t('form_upload_photo')}</span>
                    </div>
                    <input type="file" id="file-${photoId}" accept="image/*" style="display: none;" onchange="handlePhotoUpload(${photoId}, this)">
                </div>
                <div class="photo-content">
                    <textarea class="form-input form-textarea" placeholder="${t('form_photo_desc_placeholder')}" rows="3" onchange="updatePhotoDescription(${photoId}, this.value)"></textarea>
                    <button type="button" class="btn btn-error btn-small mt-2" onclick="removePhoto(${photoId})">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                </div>
            `;
            
            container.appendChild(photoDiv);
            
            // ì‚¬ì§„ ê°ì²´ ì´ˆê¸°í™”
            currentState.photos.push({
                id: photoId,
                file: null,
                description: '',
                base64: '',
                mimeType: ''
            });
        }

        function handlePhotoUpload(photoId, input) {
            const file = input.files[0];
            if (!file) return;

            const photoIndex = currentState.photos.findIndex(p => p.id === photoId);
            if (photoIndex === -1) return;

            // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.querySelector(`[data-photo-id="${photoId}"] .photo-preview`);
                preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">`;
            };
            reader.readAsDataURL(file);

            // base64ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
            const base64Reader = new FileReader();
            base64Reader.onload = function(e) {
                const base64String = e.target.result.split(',')[1];
                currentState.photos[photoIndex] = {
                    ...currentState.photos[photoIndex],
                    file: file,
                    base64: base64String,
                    mimeType: file.type
                };
            };
            base64Reader.readAsDataURL(file);
        }

        function updatePhotoDescription(photoId, description) {
            const photoIndex = currentState.photos.findIndex(p => p.id === photoId);
            if (photoIndex !== -1) {
                currentState.photos[photoIndex].description = description;
            }
        }

        function removePhoto(photoId) {
            // DOMì—ì„œ ì œê±°
            const photoElement = document.querySelector(`[data-photo-id="${photoId}"]`);
            photoElement.remove();
            
            // ìƒíƒœì—ì„œ ì œê±°
            currentState.photos = currentState.photos.filter(p => p.id !== photoId);
        }

        function openPromptReview() {
            // í¼ ê²€ì¦
            const category = document.getElementById('category').value.trim();
            const topic = document.getElementById('topic').value.trim();
            const validPhotos = currentState.photos.filter(p => p.file && p.description.trim());

            if (!category || !topic || validPhotos.length === 0) {
                alert(t('error_form_validation'));
                return;
            }

            // í”„ë¡¬í”„íŠ¸ ìƒì„±
            const prompt = generatePrompt(category, topic, validPhotos);
            document.getElementById('promptText').value = prompt;
            
            // ëª¨ë‹¬ í‘œì‹œ
            document.getElementById('promptModal').classList.add('show');
        }

        function generatePrompt(category, topic, photos) {
            const photoDescriptions = photos.map((p, i) => `- Photo ${i + 1}: ${p.description}`).join('\n');
            
            if (currentState.language === 'ko') {
                return `# AI ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ìƒì„± ê°€ì´ë“œë¼ì¸

## 1. ëª©í‘œ ë° ëª©ì 
ë¸”ë¡œê·¸ ê¸€ ì‘ì„±ì€ ê³ í’ˆì§ˆì˜ ì •ë³´ì„± ê¸€ì„ ì‘ì„±í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ê¸€ì€ ë…ìì—ê²Œ ê°€ì¹˜ë¥¼ ì œê³µí•˜ê³  ë…ìì˜ ê´€ì‹¬ì„ ëŒ ìˆ˜ ìˆëŠ” ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

## 2. ê¸€ì˜ í†¤ê³¼ ìŠ¤íƒ€ì¼
- ë…ìì—ê²Œ ì¹œê·¼í•˜ê³ , ì ‘ê·¼í•˜ê¸° ì‰¬ìš´ ì–¸ì–´ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- ê°„ê²°í•˜ê³  ëª…ë£Œí•œ ë¬¸ì¥ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **ê°€ë…ì„± ìµœì í™”**: ëŒ€ì œëª©(#), ì¤‘ì œëª©(##), ì†Œì œëª©(###)ì„ ì‚¬ìš©í•˜ì—¬ ì½˜í…ì¸ ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ ëª…í™•í•˜ê²Œ í•©ë‹ˆë‹¤.
- ì¤‘ìš”í•œ í‚¤ì›Œë“œë‚˜ ê°•ì¡°í•˜ê³  ì‹¶ì€ ë¬¸ì¥ì€ **êµµì€ ê¸€ì”¨**ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.

## 3. ê¸€ì˜ êµ¬ì¡°
### ì œëª©:
- ì œëª©ì€ ì£¼ì œë¥¼ ê°„ê²°í•˜ê³  ë§¤ë ¥ì ìœ¼ë¡œ ìš”ì•½í•©ë‹ˆë‹¤.
- **ê²€ìƒ‰ì–´ ìµœì í™”(SEO)**ë¥¼ ê³ ë ¤í•˜ì—¬ ì œëª©ì„ ì‘ì„±í•©ë‹ˆë‹¤.

### ë³¸ë¬¸:
- ì„¸ë¶€ ë‚´ìš©ì„ ì²´ê³„ì ìœ¼ë¡œ ì „ê°œí•©ë‹ˆë‹¤.
- **ì¤‘ìš”**: ë³¸ë¬¸ ë‚´ìš© ì¤‘ ì‚¬ì§„ì´ ë“¤ì–´ê°ˆ ê°€ì¥ ì ì ˆí•œ ìœ„ì¹˜ì— \`[IMAGE-1]\`, \`[IMAGE-2]\`ì™€ ê°™ì€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ë°˜ë“œì‹œ ì‚½ì…í•´ì£¼ì„¸ìš”.
- ê° í”Œë ˆì´ìŠ¤í™€ë”ëŠ” ì œê³µëœ ì‚¬ì§„ ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

## 4. ê¸€ì˜ ê¸¸ì´
- ì´ ë¸”ë¡œê·¸ ê¸€ì€ **ì•½ 2000ì**ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.

---

**[ìƒì„± ìš”ì²­]**
ìœ„ ê°€ì´ë“œë¼ì¸ì— ë”°ë¼ ì•„ë˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì™„ì „í•œ í•œêµ­ì–´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”. ìµœì¢… ê²°ê³¼ë¬¼ì€ JSON í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”:

\`\`\`json
{
  "title": "ë§¤ë ¥ì ì¸ ë¸”ë¡œê·¸ ì œëª©",
  "content": "ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì˜ ë¸”ë¡œê·¸ ë‚´ìš© (ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë” í¬í•¨)",
  "image_captions": ["ì´ë¯¸ì§€ 1 ìº¡ì…˜", "ì´ë¯¸ì§€ 2 ìº¡ì…˜", ...]
}
\`\`\`

- **ë¸”ë¡œê·¸ ì¹´í…Œê³ ë¦¬:** ${category}
- **ì£¼ìš” í† í”½/ì•„ì´ë””ì–´:** ${topic}
- **í¬í•¨í•  ì‚¬ì§„ ë° ì„¤ëª… (ìˆœì„œëŒ€ë¡œ ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ë³¸ë¬¸ì— ì‚½ì…):**
${photoDescriptions}`;
            } else {
                return `# AI Blog Post Generation Guidelines

## 1. Goal and Objective
Write a high-quality, informative blog post that provides value to readers and captures their interest.

## 2. Tone and Style
- Use friendly and accessible language.
- Use concise and clear sentences.
- **Optimize for Readability**: Use main headings (#), subheadings (##), and minor headings (###) to create a clear content hierarchy.
- Emphasize important keywords using **bold text**.

## 3. Post Structure
### Title:
- The title should be a concise and appealing summary of the topic.
- Consider **Search Engine Optimization (SEO)**.

### Body:
- Develop the main content in a structured manner.
- **Important**: Insert placeholders like \`[IMAGE-1]\`, \`[IMAGE-2]\` at the most appropriate locations in the text.
- Each placeholder must correspond to the order of the provided photos.

## 4. Post Length
- Please write this blog post to be **approximately 2000 characters**.

---

**[Generation Request]**
Based on the guidelines above, please generate a complete blog post in English using the following information. Please provide the final output in JSON format:

\`\`\`json
{
  "title": "Engaging Blog Title",
  "content": "Blog content in Markdown format (with image placeholders)",
  "image_captions": ["Image 1 caption", "Image 2 caption", ...]
}
\`\`\`

- **Blog Category:** ${category}
- **Main Topic/Idea:** ${topic}
- **Photos and Descriptions to Include:**
${photoDescriptions}`;
            }
        }

        async function generateBlogPost() {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (!apiKey) {
                showError(t('error_api_key_required'));
                document.getElementById('apiKeySection').classList.add('error');
                return;
            }

            // API í‚¤ ì €ì¥ ë° ì—ëŸ¬ ìƒíƒœ ì œê±°
            currentState.apiKey = apiKey;
            document.getElementById('apiKeySection').classList.remove('error');

            // í”„ë¡¬í”„íŠ¸ ê°€ì ¸ì˜¤ê¸°
            let prompt = document.getElementById('promptText').value.trim();
            
            // ê¸€ììˆ˜ ì„¤ì • ì ìš©
            const wordCount = document.getElementById('wordCountSelect').value;
            const customCount = document.getElementById('customWordCount').value;
            
            if (wordCount === 'custom' && customCount) {
                if (currentState.language === 'ko') {
                    prompt = prompt.replace(/\*\*ì•½ \d+ì(\sì´ìƒ)?\*\*/, `**ì•½ ${customCount}ì**`);
                } else {
                    prompt = prompt.replace(/\*\*approximately \d+ characters(\s or more)?\*\*/, `**approximately ${customCount} characters**`);
                }
            } else if (wordCount !== 'custom') {
                const suffix = wordCount === '2500' ? (currentState.language === 'ko' ? ' ì´ìƒ' : ' or more') : '';
                if (currentState.language === 'ko') {
                    prompt = prompt.replace(/\*\*ì•½ \d+ì(\sì´ìƒ)?\*\*/, `**ì•½ ${wordCount}ì${suffix}**`);
                } else {
                    prompt = prompt.replace(/\*\*approximately \d+ characters(\s or more)?\*\*/, `**approximately ${wordCount} characters${suffix}**`);
                }
            }

            // ëª¨ë‹¬ ë‹«ê¸° ë° ë¡œë”© ì‹œì‘
            document.getElementById('promptModal').classList.remove('show');
            showLoading(true);

            try {
                const validPhotos = currentState.photos.filter(p => p.file && p.description.trim());
                const result = await callGeminiAPI(prompt, validPhotos);
                
                currentState.generatedBlog = result;
                showBlogOutput(result, validPhotos);
                showLoading(false);
                
            } catch (error) {
                console.error('Blog generation failed:', error);
                showError(t('error_generation_failed'));
                showLoading(false);
            }
        }

        async function callGeminiAPI(prompt, photos) {
            const API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent';
            
            const imageParts = photos.map(photo => ({
                inlineData: {
                    data: photo.base64,
                    mimeType: photo.mimeType
                }
            }));

            const requestBody = {
                contents: [{
                    parts: [
                        { text: prompt },
                        ...imageParts
                    ]
                }],
                generationConfig: {
                    responseMimeType: "application/json",
                    temperature: 0.7,
                    responseSchema: {
                        type: "object",
                        properties: {
                            title: {
                                type: "string",
                                description: "A catchy and SEO-friendly title for the blog post."
                            },
                            content: {
                                type: "string",
                                description: "The full content of the blog post in Markdown format."
                            },
                            image_captions: {
                                type: "array",
                                items: {
                                    type: "string"
                                },
                                description: "An array of rewritten, engaging captions for each photo."
                            }
                        },
                        required: ["title", "content", "image_captions"]
                    }
                }
            };

            const response = await fetch(`${API_URL}?key=${currentState.apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`API Error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
            }

            const data = await response.json();
            const responseText = data.candidates?.[0]?.content?.parts?.[0]?.text;
            
            if (!responseText) {
                throw new Error('No response text from API');
            }

            // JSON íŒŒì‹±
            let cleanedText = responseText.trim();
            const jsonMatch = cleanedText.match(/```(?:json)?\s*([\s\S]*?)\s*```/);
            if (jsonMatch) {
                cleanedText = jsonMatch[1];
            }

            try {
                const blogObject = JSON.parse(cleanedText);
                
                if (!blogObject.title || !blogObject.content || !Array.isArray(blogObject.image_captions)) {
                    throw new Error('Invalid response structure');
                }
                
                return blogObject;
            } catch (parseError) {
                console.error('JSON parsing failed:', cleanedText);
                throw new Error('Failed to parse API response');
            }
        }

        function showLoading(show) {
            currentState.isLoading = show;
            const loadingSection = document.getElementById('loadingSection');
            const blogForm = document.getElementById('blogForm');
            const blogOutput = document.getElementById('blogOutput');
            
            if (show) {
                loadingSection.classList.remove('hidden');
                blogForm.classList.add('hidden');
                blogOutput.classList.add('hidden');
                
                // ë¡œë”© ë©”ì‹œì§€ ìˆœí™˜
                const messages = [
                    t('loading_message_1'),
                    t('loading_message_2'),
                    t('loading_message_3'),
                    t('loading_message_4'),
                    t('loading_message_5'),
                    t('loading_message_6')
                ];
                
                let messageIndex = 0;
                const messageElement = document.getElementById('loadingMessage');
                
                const updateMessage = () => {
                    messageElement.textContent = messages[messageIndex];
                    messageIndex = (messageIndex + 1) % messages.length;
                };
                
                updateMessage();
                currentState.loadingInterval = setInterval(updateMessage, 3000);
                
            } else {
                loadingSection.classList.add('hidden');
                if (currentState.loadingInterval) {
                    clearInterval(currentState.loadingInterval);
                }
            }
        }

        function showBlogOutput(blog, photos) {
            document.getElementById('blogForm').classList.add('hidden');
            document.getElementById('blogOutput').classList.remove('hidden');
            
            // ì½˜í…ì¸  ìƒì„±
            const htmlContent = convertMarkdownToHtml(blog.content, blog.image_captions, photos);
            const textContent = convertMarkdownToText(blog.content);
            
            // ê° íƒ­ ì½˜í…ì¸  ì—…ë°ì´íŠ¸
            document.getElementById('blogPreview').innerHTML = htmlContent;
            document.getElementById('htmlContent').textContent = htmlContent;
            document.getElementById('markdownContent').textContent = blog.content;
            document.getElementById('textContent').textContent = textContent;
        }

        function convertMarkdownToHtml(markdown, captions, photos) {
            let html = markdown
                // ì œëª© ë³€í™˜
                .replace(/^### (.*$)/gm, '<h3>$1</h3>')
                .replace(/^## (.*$)/gm, '<h2>$1</h2>')
                .replace(/^# (.*$)/gm, '<h1>$1</h1>')
                
                // êµµì€ ê¸€ì”¨
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                
                // ê¸°ìš¸ì„
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                
                // ì¤„ë°”ê¿ˆì„ <p> íƒœê·¸ë¡œ
                .split('\n\n')
                .map(paragraph => {
                    if (paragraph.trim() && !paragraph.startsWith('<h') && !paragraph.includes('[IMAGE-')) {
                        return `<p>${paragraph.replace(/\n/g, '<br>')}</p>`;
                    }
                    return paragraph.replace(/\n/g, '<br>');
                })
                .join('\n');

            // ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë” êµì²´
            for (let i = 0; i < photos.length; i++) {
                const imageTag = `<figure style="margin: 2rem 0; text-align: center;">
                    <img src="data:${photos[i].mimeType};base64,${photos[i].base64}" alt="${captions[i] || photos[i].description}" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <figcaption style="margin-top: 0.5rem; color: var(--text-secondary); font-style: italic;">${captions[i] || photos[i].description}</figcaption>
                </figure>`;
                html = html.replace(`[IMAGE-${i + 1}]`, imageTag);
            }

            return html;
        }

        function convertMarkdownToText(markdown) {
            return markdown
                .replace(/^#{1,6}\s/gm, '')
                .replace(/\*\*(.*?)\*\*/g, '$1')
                .replace(/\*(.*?)\*/g, '$1')
                .replace(/\[IMAGE-\d+\]/g, '[ì´ë¯¸ì§€]')
                .replace(/\n{3,}/g, '\n\n')
                .trim();
        }

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                const button = element.parentElement.querySelector('button');
                const originalText = button.textContent;
                button.textContent = t('success_copied');
                
                setTimeout(() => {
                    button.innerHTML = `<span data-i18n="${elementId.replace('Content', '').replace(/^(.)/, (match) => `output_copy_${match.toLowerCase()}`)}"></span>`;
                    updateLanguage(currentState.language);
                }, 2000);
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
            });
        }

        function openAddContentModal() {
            document.getElementById('addContentModal').classList.add('show');
            document.getElementById('additionalPhotos').innerHTML = '';
        }

        function addAdditionalPhoto() {
            const container = document.getElementById('additionalPhotos');
            const photoId = Date.now();
            
            const photoDiv = document.createElement('div');
            photoDiv.className = 'photo-item';
            photoDiv.dataset.additionalPhotoId = photoId;
            
            photoDiv.innerHTML = `
                <div class="photo-preview" onclick="document.getElementById('additional-file-${photoId}').click()">
                    <div class="upload-placeholder">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <polyline points="21,15 16,10 5,21"/>
                        </svg>
                        <span>${t('form_upload_photo')}</span>
                    </div>
                    <input type="file" id="additional-file-${photoId}" accept="image/*" style="display: none;" onchange="handleAdditionalPhotoUpload(${photoId}, this)">
                </div>
                <div class="photo-content">
                    <textarea class="form-input form-textarea" placeholder="${t('form_photo_desc_placeholder')}" rows="3"></textarea>
                    <button type="button" class="btn btn-error btn-small mt-2" onclick="removeAdditionalPhoto(${photoId})">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                </div>
            `;
            
            container.appendChild(photoDiv);
        }

        function handleAdditionalPhotoUpload(photoId, input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.querySelector(`[data-additional-photo-id="${photoId}"] .photo-preview`);
                preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">`;
            };
            reader.readAsDataURL(file);
        }

        function removeAdditionalPhoto(photoId) {
            const photoElement = document.querySelector(`[data-additional-photo-id="${photoId}"]`);
            photoElement.remove();
        }

        async function addContentToBlog() {
            const instructions = document.getElementById('addInstructions').value.trim();
            const additionalPhotoElements = document.querySelectorAll('[data-additional-photo-id]');
            
            // ì¶”ê°€ ì‚¬ì§„ë“¤ ì²˜ë¦¬
            const additionalPhotos = [];
            for (let element of additionalPhotoElements) {
                const photoId = element.dataset.additionalPhotoId;
                const fileInput = document.getElementById(`additional-file-${photoId}`);
                const textarea = element.querySelector('textarea');
                
                if (fileInput.files[0] && textarea.value.trim()) {
                    const file = fileInput.files[0];
                    const base64 = await fileToBase64(file);
                    
                    additionalPhotos.push({
                        id: photoId,
                        file: file,
                        description: textarea.value.trim(),
                        base64: base64.split(',')[1],
                        mimeType: file.type
                    });
                }
            }

            if (!instructions && additionalPhotos.length === 0) {
                alert(t('output_addup_validation_error_empty'));
                return;
            }

            // ëª¨ë“  ì‚¬ì§„ í•©ì¹˜ê¸° (ê¸°ì¡´ + ì¶”ê°€)
            const allPhotos = [...currentState.photos.filter(p => p.file), ...additionalPhotos];
            
            // ì¶”ê°€ í”„ë¡¬í”„íŠ¸ ìƒì„±
            const addUpPrompt = generateAddUpPrompt(instructions, currentState.generatedBlog, allPhotos);
            
            // ëª¨ë‹¬ ë‹«ê¸° ë° ë¡œë”© ì‹œì‘
            document.getElementById('addContentModal').classList.remove('show');
            showLoading(true);

            try {
                const result = await callGeminiAPI(addUpPrompt, allPhotos);
                
                currentState.generatedBlog = result;
                currentState.photos = allPhotos; // ì‚¬ì§„ ëª©ë¡ ì—…ë°ì´íŠ¸
                showBlogOutput(result, allPhotos);
                showLoading(false);
                
            } catch (error) {
                console.error('Add content failed:', error);
                showError(t('error_generation_failed'));
                showLoading(false);
            }
        }

        function generateAddUpPrompt(instructions, currentBlog, allPhotos) {
            const photoDescriptions = allPhotos.map((p, i) => `- Photo ${i + 1}: ${p.description}`).join('\n');
            
            if (currentState.language === 'ko') {
                return `# AI ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ìˆ˜ì • ë° í™•ì¥ ê°€ì´ë“œë¼ì¸

## 1. ëª©í‘œ
ê¸°ì¡´ì— ì‘ì„±ëœ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©ìì˜ ì¶”ê°€ ì§€ì¹¨ì— ë”°ë¼ ìˆ˜ì •í•˜ê³  í™•ì¥í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ê¸°ì¡´ ê¸€ì˜ í†¤, ìŠ¤íƒ€ì¼, êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ìƒˆë¡œìš´ ë‚´ìš©ì„ ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©í•´ì•¼ í•©ë‹ˆë‹¤.

## 2. ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë‚´ìš©
### ì œëª©:
${currentBlog.title}

### ë³¸ë¬¸ (Markdown):
\`\`\`markdown
${currentBlog.content}
\`\`\`

## 3. ì‚¬ìš©ì ì¶”ê°€ ìš”ì²­ì‚¬í•­
ë‹¤ìŒì€ ì‚¬ìš©ìê°€ ìš”ì²­í•œ ìˆ˜ì • ë° ì¶”ê°€ ë‚´ìš©ì…ë‹ˆë‹¤. ì´ ë‚´ìš©ì„ ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì— ë°˜ì˜í•´ì£¼ì„¸ìš”.
- **ì¶”ê°€ ì§€ì¹¨:** ${instructions || "ì—†ìŒ"}

## 4. ì „ì²´ ì‚¬ì§„ ëª©ë¡
ìˆ˜ì •ëœ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì—ëŠ” ì•„ë˜ì˜ ëª¨ë“  ì‚¬ì§„ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê¸°ì¡´ ì‚¬ì§„ê³¼ ìƒˆë¡œ ì¶”ê°€ëœ ì‚¬ì§„ì´ ëª¨ë‘ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë³¸ë¬¸ ë‚´ìš©ì— ë§ê²Œ ê° ì‚¬ì§„ì˜ ìœ„ì¹˜ë¥¼ ì¬ë°°ì¹˜í•˜ê³ , ê°€ì¥ ì ì ˆí•œ ê³³ì— \`[IMAGE-1]\`, \`[IMAGE-2]\`... ì™€ ê°™ì€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì‚½ì…í•´ì£¼ì„¸ìš”.
- **ì‚¬ìš©í•  ì‚¬ì§„ ë° ì„¤ëª… (ìˆœì„œëŒ€ë¡œ ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ë³¸ë¬¸ì— ì‚½ì…):**
${photoDescriptions}

## 5. ìµœì¢… ê²°ê³¼ë¬¼ ìš”êµ¬ì‚¬í•­
- ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì˜ ë‚´ìš©ê³¼ ìƒˆë¡œìš´ ìš”ì²­ì‚¬í•­ì„ ì™„ë²½í•˜ê²Œ í†µí•©í•˜ì—¬ **í•˜ë‚˜ì˜ ì™„ì„±ëœ ìƒˆ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸**ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.
- ìµœì¢… ê²°ê³¼ë¬¼ì€ JSON í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”:

\`\`\`json
{
  "title": "ìˆ˜ì •ëœ ë¸”ë¡œê·¸ ì œëª©",
  "content": "ìˆ˜ì •ëœ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì˜ ë¸”ë¡œê·¸ ë‚´ìš©",
  "image_captions": ["ëª¨ë“  ì´ë¯¸ì§€ì— ëŒ€í•œ ìº¡ì…˜ ë°°ì—´"]
}
\`\`\`

---

**[ìˆ˜ì • ë° í™•ì¥ ìš”ì²­]**
ìœ„ ê°€ì´ë“œë¼ì¸ê³¼ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì™„ì „í•œ í•œêµ­ì–´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ì¬ìƒì„±í•´ì£¼ì„¸ìš”.`;
            } else {
                return `# AI Blog Post Revision and Expansion Guidelines

## 1. Goal
The goal is to revise and expand a previously generated blog post based on the user's additional instructions. The new content should be seamlessly integrated while maintaining the original tone, style, and structure.

## 2. Existing Blog Post Content
### Title:
${currentBlog.title}

### Body (Markdown):
\`\`\`markdown
${currentBlog.content}
\`\`\`

## 3. User's Additional Requests
The following are the user's requested revisions and additions. Please incorporate these into the existing blog post.
- **Additional Instructions:** ${instructions || "None"}

## 4. Full List of Photos
The revised blog post must use all of the photos listed below, including both original and newly added ones. Please rearrange the placement of each photo as needed to fit the content, and insert placeholders like \`[IMAGE-1]\`, \`[IMAGE-2]\`... in the most appropriate locations.
- **Photos to Use (insert image placeholders in order):**
${photoDescriptions}

## 5. Final Output Requirements
- Perfectly integrate the existing blog post content with the new requests to generate **one complete, new blog post**.
- The final output must be in JSON format:

\`\`\`json
{
  "title": "Updated Blog Title",
  "content": "Updated blog content in Markdown format",
  "image_captions": ["Array of captions for all images"]
}
\`\`\`

---

**[Revision and Expansion Request]**
Based on the guidelines and information above, please regenerate a complete blog post in English.`;
            }
        }

        function openToneModal() {
            document.getElementById('toneModal').classList.add('show');
        }

        async function adjustTone() {
            const toneSettings = {
                formality: document.getElementById('toneFormality').value,
                enthusiasm: document.getElementById('toneEnthusiasm').value,
                confidence: document.getElementById('toneConfidence').value,
                humor: document.getElementById('toneHumor').value,
                clarity: document.getElementById('toneClarity').value
            };

            // í†¤ ì¡°ì • í”„ë¡¬í”„íŠ¸ ìƒì„±
            const allPhotos = currentState.photos.filter(p => p.file);
            const tonePrompt = generateToneAdjustPrompt(toneSettings, currentState.generatedBlog, allPhotos);
            
            // ëª¨ë‹¬ ë‹«ê¸° ë° ë¡œë”© ì‹œì‘
            document.getElementById('toneModal').classList.remove('show');
            showLoading(true);

            try {
                const result = await callGeminiAPI(tonePrompt, allPhotos);
                
                currentState.generatedBlog = result;
                showBlogOutput(result, allPhotos);
                showLoading(false);
                
            } catch (error) {
                console.error('Tone adjustment failed:', error);
                showError(t('error_generation_failed'));
                showLoading(false);
            }
        }

        function generateToneAdjustPrompt(toneSettings, currentBlog, allPhotos) {
            const photoDescriptions = allPhotos.map((p, i) => `- Photo ${i + 1}: ${p.description}`).join('\n');
            
            if (currentState.language === 'ko') {
                return `# AI ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ í†¤ ì¡°ì ˆ ê°€ì´ë“œë¼ì¸

## 1. ëª©í‘œ
ê¸°ì¡´ì— ì‘ì„±ëœ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì˜ **í†¤ê³¼ ìŠ¤íƒ€ì¼**ì„ ì‚¬ìš©ìì˜ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ë‹¤ì‹œ ì‘ì„±í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ê¸€ì˜ í•µì‹¬ ë‚´ìš©, êµ¬ì¡°, ê·¸ë¦¬ê³  ì‚¬ì§„ ë°°ì¹˜ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.

## 2. ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë‚´ìš©
### ì œëª©:
${currentBlog.title}

### ë³¸ë¬¸ (Markdown):
\`\`\`markdown
${currentBlog.content}
\`\`\`

## 3. ìƒˆë¡œìš´ í†¤ ìš”êµ¬ì‚¬í•­
ì•„ë˜ì˜ í†¤ ì§€í‘œì— ë”°ë¼ ê¸€ì˜ ì „ì²´ì ì¸ ë¶„ìœ„ê¸°ë¥¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”. ë‹¨ì–´ ì„ íƒ, ë¬¸ì¥ êµ¬ì¡°, í‘œí˜„ ë°©ì‹ ë“±ì„ ì¡°ì ˆí•˜ì—¬ ìƒˆë¡œìš´ í†¤ì„ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

- **ê²©ì‹ (Formality):** ${toneSettings.formality}
- **ì—´ì • (Enthusiasm):** ${toneSettings.enthusiasm}
- **ìì‹ ê° (Confidence):** ${toneSettings.confidence}
- **ìœ ë¨¸ (Humor):** ${toneSettings.humor}
- **ëª…í™•ì„± (Clarity):** ${toneSettings.clarity}

## 4. ì‚¬ì§„ ëª©ë¡
ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì— ì‚¬ìš©ëœ ì‚¬ì§„ ëª©ë¡ì…ë‹ˆë‹¤. í†¤ì„ ì¡°ì ˆí•  ë•Œ, ì‚¬ì§„ê³¼ ê´€ë ¨ëœ ë‚´ìš©ì´ ì–´ìƒ‰í•´ì§€ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ê³ , **ì‚¬ì§„ ìº¡ì…˜('image_captions')** ë˜í•œ ìƒˆë¡œìš´ í†¤ì— ë§ê²Œ ìì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
- **ì‚¬ìš©ëœ ì‚¬ì§„ ë° ì„¤ëª…:**
${photoDescriptions}

## 5. ìµœì¢… ê²°ê³¼ë¬¼ ìš”êµ¬ì‚¬í•­
- **í•µì‹¬ ë‚´ìš©ê³¼ êµ¬ì¡°ëŠ” ë³€ê²½í•˜ì§€ ë§ˆì„¸ìš”.** ì˜¤ì§ ê¸€ì˜ í†¤ê³¼ ìŠ¤íƒ€ì¼ë§Œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- ë³¸ë¬¸ ë‚´ì˜ ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë”(\`[IMAGE-1]\` ë“±)ëŠ” ì›ë˜ ìœ„ì¹˜ë¥¼ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.
- ìµœì¢… ê²°ê³¼ë¬¼ì€ JSON í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì£¼ì„¸ìš”:

\`\`\`json
{
  "title": "${currentBlog.title}",
  "content": "ìƒˆë¡œìš´ í†¤ìœ¼ë¡œ ìˆ˜ì •ëœ ë§ˆí¬ë‹¤ìš´ ë‚´ìš©",
  "image_captions": ["ìƒˆë¡œìš´ í†¤ì— ë§ëŠ” ì´ë¯¸ì§€ ìº¡ì…˜ë“¤"]
}
\`\`\`

---

**[í†¤ ì¡°ì ˆ ì¬ì‘ì„± ìš”ì²­]**
ìœ„ ê°€ì´ë“œë¼ì¸ê³¼ ìƒˆë¡œìš´ í†¤ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼, ê¸°ì¡´ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ í•œêµ­ì–´ë¡œ ë‹¤ì‹œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;
            } else {
                return `# AI Blog Post Tone Adjustment Guidelines

## 1. Goal
The primary goal is to rewrite an existing blog post to match new **tone and style** requirements provided by the user. The core content, structure, and photo placements must remain the same.

## 2. Existing Blog Post Content
### Title:
${currentBlog.title}

### Body (Markdown):
\`\`\`markdown
${currentBlog.content}
\`\`\`

## 3. New Tone Requirements
Please revise the overall feel of the post according to the following tone metrics. This should be reflected in word choice, sentence structure, and phrasing.

- **Formality:** ${toneSettings.formality}
- **Enthusiasm:** ${toneSettings.enthusiasm}
- **Confidence:** ${toneSettings.confidence}
- **Humor:** ${toneSettings.humor}
- **Clarity:** ${toneSettings.clarity}

## 4. Photo List
This is the list of photos used in the blog post. As you adjust the tone, ensure the content related to the photos remains relevant, and please **rewrite the photo captions ('image_captions')** to naturally fit the new tone.
- **Photos Used:**
${photoDescriptions}

## 5. Final Output Requirements
- **Do not change the core content or structure.** The rewrite should only affect the tone and style.
- Image placeholders (\`[IMAGE-1]\`, etc.) in the body must be preserved in their original locations.
- The final output must be in JSON format:

\`\`\`json
{
  "title": "${currentBlog.title}",
  "content": "Tone-adjusted markdown content",
  "image_captions": ["Tone-adjusted image captions"]
}
\`\`\`

---

**[Tone Adjustment Rewrite Request]**
Based on the guidelines and new tone requirements above, please rewrite the blog post in English.`;
            }
        }

        function resetApp() {
            // ìƒíƒœ ì´ˆê¸°í™”
            currentState.generatedBlog = null;
            currentState.photos = [];
            
            // UI ì´ˆê¸°í™”
            document.getElementById('blogForm').classList.remove('hidden');
            document.getElementById('blogOutput').classList.add('hidden');
            document.getElementById('category').value = '';
            document.getElementById('topic').value = '';
            document.getElementById('photoContainer').innerHTML = '';
            
            // ì´ˆê¸° ì‚¬ì§„ í•„ë“œ ì¶”ê°€
            addInitialPhoto();
        }

        function showError(message) {
            alert(message);
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
    </script>
</body>
</html>